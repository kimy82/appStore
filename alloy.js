function ucfirst(t){return t?t[0].toUpperCase()+t.substr(1):t}function addNamespace(t){return(CONST.IMPLICIT_NAMESPACES[t]||CONST.NAMESPACE_DEFAULT)+"."+t}function processStyle(t,e,n,r,i){r=r||{},r.classes=n,e.apiName&&(r.apiName=e.apiName),e.id&&(r.id=e.id),e.applyProperties(exports.createStyle(t,r,i))}function isTabletFallback(){return Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)>=700}var _=require("alloy/underscore")._,Backbone=require("alloy/backbone"),CONST=require("alloy/constants");exports.version="1.2.2",exports._=_,exports.Backbone=Backbone;var DEFAULT_WIDGET="widget",IDENTITY_TRANSFORM=void 0,RESET={bottom:null,left:null,right:null,top:null,height:null,width:null,shadowColor:null,shadowOffset:null,backgroundImage:null,backgroundRepeat:null,center:null,layout:null,backgroundSelectedColor:null,backgroundSelectedImage:null,opacity:1,touchEnabled:!0,enabled:!0,horizontalWrap:!0,zIndex:0,backgroundColor:null,font:null,visible:!0,color:null,transform:null,backgroundGradient:{},borderColor:"transparent",borderRadius:null,borderWidth:null};exports.M=function(t,e,n){var r,i=(e||{}).config||{},a=i.adapter||{},o={},s={};a.type?(r=require("alloy/sync/"+a.type),o.sync=function(t,e,n){r.sync(t,e,n)}):o.sync=function(t,e){Ti.API.warn("Execution of "+t+"#sync() function on a model that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(e.toJSON()))},o.defaults=i.defaults,n&&(s.migrations=n),r&&_.isFunction(r.beforeModelCreate)&&(i=r.beforeModelCreate(i,t)||i);var l=Backbone.Model.extend(o,s);return l.prototype.config=i,_.isFunction(e.extendModel)&&(l=e.extendModel(l)||l),r&&_.isFunction(r.afterModelCreate)&&r.afterModelCreate(l,t),l},exports.C=function(t,e,n){var r,i={model:n},a=(n?n.prototype.config:{})||{};a.adapter&&a.adapter.type?(r=require("alloy/sync/"+a.adapter.type),i.sync=function(t,e,n){r.sync(t,e,n)}):i.sync=function(t,e){Ti.API.warn("Execution of "+t+"#sync() function on a collection that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(e.toJSON()))};var o=Backbone.Collection.extend(i);return o.prototype.config=a,_.isFunction(e.extendCollection)&&(o=e.extendCollection(o)||o),r&&_.isFunction(r.afterCollectionCreate)&&r.afterCollectionCreate(o),o},exports.UI={},exports.UI.create=function(controller,apiName,opts){opts=opts||{};var baseName,ns,parts=apiName.split(".");if(1===parts.length)baseName=apiName,ns=opts.ns||CONST.IMPLICIT_NAMESPACES[baseName]||CONST.NAMESPACE_DEFAULT;else{if(!(parts.length>1))throw"Alloy.UI.create() failed: No API name was given in the second parameter";baseName=parts[parts.length-1],ns=parts.slice(0,parts.length-1).join(".")}opts.apiName=ns+"."+baseName,baseName=baseName[0].toUpperCase()+baseName.substr(1);var style=exports.createStyle(controller,opts);return eval(ns)["create"+baseName](style)},exports.createStyle=function(t,e,n){var r,i;if(!e)return{};r=_.isArray(e.classes)?e.classes.slice(0):_.isString(e.classes)?e.classes.split(/\s+/):[],i=e.apiName,i&&-1===i.indexOf(".")&&(i=addNamespace(i));var a;a=t&&_.isObject(t)?require("alloy/widgets/"+t.widgetId+"/styles/"+t.name):require("alloy/styles/"+t);var o,s,l={};for(o=0,s=a.length;s>o;o++){var u=a[o],c=u.key;if(u.isApi&&-1===c.indexOf(".")&&(c=(CONST.IMPLICIT_NAMESPACES[c]||CONST.NAMESPACE_DEFAULT)+"."+c),u.isId&&e.id&&u.key===e.id||u.isClass&&_.contains(r,u.key));else{if(!u.isApi)continue;if(-1===u.key.indexOf(".")&&(u.key=addNamespace(u.key)),u.key!==i)continue}u.queries&&u.queries.formFactor&&!Alloy[u.queries.formFactor]||_.extend(l,u.style)}var d=_.omit(e,[CONST.CLASS_PROPERTY,CONST.APINAME_PROPERTY]);return _.extend(l,d),l[CONST.CLASS_PROPERTY]=r,l[CONST.APINAME_PROPERTY]=i,n?_.defaults(l,n):l},exports.addClass=function(t,e,n,r){if(!n)return r&&e.applyProperties(r),void 0;var i=e[CONST.CLASS_PROPERTY]||[],a=i.length;n=_.isString(n)?n.split(/\s+/):n;var o=_.union(i,n||[]);return a===o.length?(r&&e.applyProperties(r),void 0):(processStyle(t,e,o,r),void 0)},exports.removeClass=function(t,e,n,r){n=n||[];var i=e[CONST.CLASS_PROPERTY]||[],a=i.length;if(!a||!n.length)return r&&e.applyProperties(r),void 0;n=_.isString(n)?n.split(/\s+/):n;var o=_.difference(i,n);return a===o.length?(r&&e.applyProperties(r),void 0):(processStyle(t,e,o,r,RESET),void 0)},exports.resetClass=function(t,e,n,r){n=n||[],n=_.isString(n)?n.split(/\s+/):n,processStyle(t,e,n,r,RESET)},exports.createWidget=function(t,e,n){return e!==void 0&&null!==e&&_.isObject(e)&&!_.isString(e)&&(n=e,e=DEFAULT_WIDGET),new(require("alloy/widgets/"+t+"/controllers/"+(e||DEFAULT_WIDGET)))(n)},exports.createController=function(t,e){return new(require("alloy/controllers/"+t))(e)},exports.createModel=function(t,e){return new(require("alloy/models/"+ucfirst(t)).Model)(e)},exports.createCollection=function(t,e){return new(require("alloy/models/"+ucfirst(t)).Collection)(e)},exports.isTablet=function(){return Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)>=400}(),exports.isHandheld=!exports.isTablet,exports.Globals={},exports.Models={},exports.Models.instance=function(t){return exports.Models[t]||(exports.Models[t]=exports.createModel(t))},exports.Collections={},exports.Collections.instance=function(t){return exports.Collections[t]||(exports.Collections[t]=exports.createCollection(t))},exports.CFG=require("alloy/CFG");