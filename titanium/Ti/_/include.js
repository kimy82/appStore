define(function(){var t={},e=[];return{dynamic:!0,normalize:function(t,e){var i=t.split("!"),n=i[0];return i.shift(),(/^\./.test(n)?e(n):n)+(i.length?"!"+i.join("!"):"")},load:function(i,n,r){var o,a,s,u,l=i.split("!"),c=l.length;if((u=c>1&&"sandbox"===l[0])&&(l.shift(),i=l.join("!")),s=n.toUrl(/^\//.test(i)?i:"./"+i,e.length?{name:e[e.length-1]}:null),o=t[s]||n.cache(s),!o){if(a=new XMLHttpRequest,a.open("GET",s,!1),a.send(null),200!==a.status)throw Error('Failed to load include "'+s+'": '+a.status);o=a.responseText}e.push(s);try{n.evaluate(t[s]=o,0,!u)}catch(h){throw h}finally{e.pop()}r(o)}}});