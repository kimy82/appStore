define(["Ti/_/css","Ti/_/declare","Ti/UI/View","Ti/UI","Ti/_/lang"],function(t,e,i,n,r){var o=r.isDef,a=n.FILL,s="TiUINavigationGroup";return e("Ti.UI.MobileWeb.NavigationGroup",i,{constructor:function(e){var i=this,r=i.constants.window=e&&e.window,o=i._navBarContainer=n.createView({height:50,width:n.FILL,layout:n._LAYOUT_CONSTRAINING_HORIZONTAL});t.add(o.domNode,s),i.layout=n._LAYOUT_CONSTRAINING_VERTICAL,o.add(i._leftContainer=n.createView({width:n.SIZE,height:"100%",left:5,right:5})),o.add(i._centerContainer=n.createView({width:n.FILL,height:"100%"})),o.add(i._rightContainer=n.createView({width:n.SIZE,height:"100%",left:5,right:5})),i._add(o),i._add(i._contentContainer=n.createView({width:a,height:a})),this.navBarAtTop=!0,o._getBorderFromCSS(),i._windows=[],r&&i.open(r)},_defaultWidth:a,_defaultHeight:a,_updateNavBar:function(){var t,e,i,r=this,o=r._windows,a=o.length,s=o[a-1],u=this._navBarContainer,l=r._leftContainer,c=r._centerContainer,d=r._rightContainer;s&&(i=s.rightNavButton,s.leftNavButton?t=s.leftNavButton:(r._backButton||(r._backButton=n.createButton({title:"Back"}),require.on(r._backButton,"singletap",function(){r.close(o[o.length-1])})),a>1&&(t=r._backButton)),l._children[0]!==t&&(l._removeAllChildren(),t&&l._add(t)),d._children[0]!==i&&(d._removeAllChildren(),i&&d._add(i)),u.backgroundColor=s.barColor,u.backgroundImage=s.barImage,u.opacity=s.translucent?.5:1,u.height=s.navBarHidden&&s.modal?0:50,e=s.titleControl?s.titleControl:s.titleImage?s._titleImageView||(s._titleImageView=n.createImageView({image:s.titleImage})):s._titleControl||(s._titleControl=n.createLabel({text:s._getTitle()||this._tab&&this._tab._getTitle()||"",width:"100%",height:"100%",textAlign:n.TEXT_ALIGNMENT_CENTER})),c._children[0]!==e&&(c._removeAllChildren(),e&&c._add(e)))},_getTopWindow:function(){var t=this._windows,e=t.length;return e?t[t.length-1]:null},open:function(t){if(!t._opened){var e=this._windows,i=this._tab;t._navGroup=this,!o(t.backgroundColor)&&!o(t.backgroundImage)&&(t.backgroundColor="#fff"),~(e.length-1)&&e[e.length-1].fireEvent("blur"),i&&(t.tabGroup=(t.tab=i)._tabGroup),e.push(t),this._contentContainer._add(t),this._updateNavBar(),t._opened||t.fireEvent("open"),t._opened=1,t.fireEvent("focus")}},close:function(t){var e=this._windows,i=e.indexOf(t),n=this;t._navGroup=void 0,i>0&&(e.splice(i,1),t.fireEvent("blur"),n._contentContainer.remove(t),t.fireEvent("close"),t._opened=0,this._updateNavBar(),e[e.length-1].fireEvent("focus"))},_reset:function(){for(var t,e=this._windows,i=e.length-1,n=i;;){if(t=e[i],!i)break;i--===n&&t.fireEvent("blur"),this._contentContainer.remove(t),t.fireEvent("close"),t._opened=0}e.splice(1),this._updateNavBar(),t.fireEvent("focus")},constants:{window:void 0,bubbleParent:!1},properties:{navBarAtTop:{set:function(e,i){if(e!==i){var n=this._navBarContainer,r=n.domNode;this._remove(n),this._insertAt(n,e?0:1),t.remove(r,s+(e?"Top":"Bottom")),t.add(r,s+(e?"Bottom":"Top"))}return e}}}})});